<!doctype html>
<html>
				<head>
								<meta charset="utf-8">
								<link rel="shortcut icon" href="https://a107studio.github.io/img/logo.ico">
								<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>								<title>107Studio--login</title>
				</head>
				<body onload="check()">
								<h1>这是一个一个一个登录界面啊啊啊啊（恼</h1>
								<p>出于对作品的保护以及防止玷污有些人高贵的眼睛，本站特设登录界面</p>
								<p>请输入用户名</p>
								<p><input type="text" value="" id="userId"/></p>
								<p>请输入密码</p>
								<p><input type="text" value="" id="password"/></p>								<button onClick="login()">登录！</button>
							<script>
												function login(){
        $.ajax({
        url:"https://101.43.151.15:7777/login",
            type:"post",
            dataType:"json",
 
            //data为要传递给后端的数据，使用JSON.stringify()转换为json格式
            data:JSON.stringify({
                    userId:   $("#userId").val(),
                    password: $("#password").val()
                }),
                xhrFields: {
        withCredentials: true
    },
    crossDomain: true,
            success:function (data){
            if(data.status==="accept") {
            				alert("登录成功!")  
            				   window.location.href="/homepage.html"
            }
             if(data.status==="unaccept") {
             				alert("密码错了捏")
             }   
             if(data.status==="nouser") {
             				alert("先注册一个账号捏")
             }
            },
            error:function () {
            				alert("服务器连接失败")
            }
        })
    }
    				function check() {
    								
								$.ajax({
												url:"https://101.43.151.15:7777/check",
            type:"get",
            dataType:"json",
                    xhrFields: {
        withCredentials: true
    },
    crossDomain: true,
            success:    function (data) {
            				if(data.status==='accept') {
            			var name=data.username
            				alert("欢迎，"+name+"!");
            								window.location.href='/homepage.html'
            				}
            				if(data.status==='unaccept') {
            								//alert('请登录')
            							//window.location.href='/'
            							return           				}
            },
             error:     function () {
             alert('服务器连接失败')
             				//window.location.href='/'
             }    
								})
								
				}
							</script>
												
						<div id="foot">
										<p>没有账号？</p>
                                    <a href="/register" target="_blank">戳这里注册！</a>
                                </div>						
				</body>
				
                <h1>107Studio制作</h1>
</html>
